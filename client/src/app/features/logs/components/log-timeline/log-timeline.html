<div class="log-timeline">
  <div class="log-timeline__header">
    <h2 class="log-timeline__query">{{ session.query }}</h2>
    <div class="log-timeline__meta">
      <span class="log-timeline__logid">
        LogID: {{ session.logId }}
        <button class="log-timeline__copy-btn" (click)="copyLogId()">ðŸ“‹</button>
      </span>
      <span class="log-timeline__duration">
        Total: {{ formatDuration(session.totalDuration) }}
      </span>
      <span class="log-timeline__status" [class]="'log-timeline__status--' + session.status">
        {{ session.status }}
      </span>
    </div>
  </div>

  <!-- Research Result Section -->
  <div class="log-timeline__result" *ngIf="result">
    <div class="log-timeline__result-header">
      <h3>Research Answer</h3>
    </div>
    <div class="log-timeline__result-content">
      <div class="log-timeline__answer">{{ result.answer }}</div>

      <div class="log-timeline__sources" *ngIf="result.sources && result.sources.length > 0">
        <h4>Sources</h4>
        <ul>
          <li *ngFor="let source of result.sources">
            <a [href]="source.url" target="_blank" rel="noopener noreferrer">{{ source.title }}</a>
            <span class="log-timeline__source-relevance">({{ source.relevance }})</span>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="log-timeline__loading" *ngIf="isLoading">
    <div class="skeleton-stage" *ngFor="let i of [1,2,3]">
      <div class="skeleton-stage__header"></div>
    </div>
  </div>

  <div class="log-timeline__stages" *ngIf="!isLoading">
    <app-stage-node
      *ngFor="let stage of timelineNodes; let i = index; let last = last"
      [node]="stage"
      [isLast]="last"
    />
  </div>

  <div class="log-timeline__empty" *ngIf="!isLoading && timelineNodes.length === 0">
    <p>No timeline data available for this session</p>
  </div>
</div>
